{% extends "base.html" %}
{% load markup %}
{% load floppyforms %}

{% block body %}
<style>
#id_yaml {width:98%; font-family:"inconsolata", "menlo", monospace;}


</style>
<script>
$(document).ready(function() {
    var $abc = $("#id_yaml");
    $abc.css("height", $abc.attr("scrollHeight"));
})
</script>

<form action="." method="POST" accept-charset="utf-8">
<div class="container">


    <div class="row">

       <div class="span12">
        <hr>
            <a class='btn btn-mini pull-right' href='{% url "admin:ask_asker_change" asker.id %}'>Edit details</a>
            <a class='btn btn-mini btn-primary pull-right' href='{% url "preview_asker" asker.id 0 %}'>Preview</a>

            <p><input class="btn btn-primary" type="Submit" value="Save changes"></p>

        <hr>
        </div>
    </div>


<div class="row">

        {% csrf_token %}

<div class="span8">


    <h4>Text input </h4>
    {{form.yaml}}

</div>

</form>
<div class="span4">
    <h4>Questionnaire preview</h4>
{% for i in asker.askpage_set.all %}

{% if not forloop.first %}
<div class="control-group">&nbsp;</div>
<p class="muted pull-right">page {{i.page_number}}</p><hr>
<div class="control-group">&nbsp;</div>
{% endif %}

    {% for j in i.get_questions %}
    <div class="well">

            <code>{{j.variable_name}}</code>
            <span class="muted pull-right">{{j.q_type}}, required: {{j.required}}{% if j.showif %}; show if <code>{{j.showif.as_markdown}}</code><br>{% endif %}</span>

            <hr>
            {{j.text|markdown}}
            {% if j.choices.count > 0 %}
                <a class="btn btn-mini pull-right" href="{% url "admin:ask_choiceset_change" j.choiceset.id %}">Edit choices</a>

            {% endif %}

            {% if j.score_mapping %}
                Scores on this question will be remapped as follows when computing summaries: <pre>{{j.score_mapping}}</pre>
            {% endif %}

        </div>


        {% endfor %}
{% endfor %}
</div>

</div>





</div>



{% endblock %}
